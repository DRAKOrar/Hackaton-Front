<!-- src/app/pages/register/register.page.html -->
<ion-header class="ion-no-border">
  <ion-toolbar>
    <ion-title>Crear Cuenta</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="register-content">
  <div class="register-container">
    <div class="welcome-section">
      <div class="icon-wrapper">
        <ion-icon name="person-add-outline"></ion-icon>
      </div>
      <h1>¡Bienvenido!</h1>
      <p>Completa tus datos para comenzar</p>
    </div>

    <form [formGroup]="registerForm" (ngSubmit)="onSubmit()">
      <ion-card class="form-card">
        <ion-card-content>
          <!-- Sección de Datos de Acceso -->
          <div class="form-section">
            <h3 class="section-title">
              <ion-icon name="key-outline"></ion-icon>
              Datos de Acceso
            </h3>

            <!-- Username -->
            <div class="input-group">
              <ion-item lines="none" [class.error]="registerForm.get('username')?.invalid && registerForm.get('username')?.touched">
                <ion-icon name="at-outline" slot="start"></ion-icon>
                <ion-label position="floating">Username</ion-label>
                <ion-input
                  formControlName="username"
                  type="text"
                  placeholder="Tu nombre de usuario">
                </ion-input>
              </ion-item>
              <ion-note *ngIf="registerForm.get('username')?.invalid && registerForm.get('username')?.touched" class="error-note">
                <div *ngIf="registerForm.get('username')?.errors?.['required']">
                  <ion-icon name="alert-circle-outline"></ion-icon>
                  El username es requerido
                </div>
                <div *ngIf="registerForm.get('username')?.errors?.['minlength']">
                  <ion-icon name="alert-circle-outline"></ion-icon>
                  Mínimo 3 caracteres
                </div>
              </ion-note>
            </div>

            <!-- Email -->
            <div class="input-group">
              <ion-item lines="none" [class.error]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
                <ion-icon name="mail-outline" slot="start"></ion-icon>
                <ion-label position="floating">Email</ion-label>
                <ion-input
                  formControlName="email"
                  type="email"
                  placeholder="correo@ejemplo.com">
                </ion-input>
              </ion-item>
              <ion-note *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched" class="error-note">
                <div *ngIf="registerForm.get('email')?.errors?.['required']">
                  <ion-icon name="alert-circle-outline"></ion-icon>
                  El email es requerido
                </div>
                <div *ngIf="registerForm.get('email')?.errors?.['email']">
                  <ion-icon name="alert-circle-outline"></ion-icon>
                  Email no válido
                </div>
              </ion-note>
            </div>

            <!-- Password -->
            <div class="input-group">
              <ion-item lines="none" [class.error]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
                <ion-icon name="lock-closed-outline" slot="start"></ion-icon>
                <ion-label position="floating">Contraseña</ion-label>
                <ion-input
                  formControlName="password"
                  type="password"
                  placeholder="Mínimo 6 caracteres">
                </ion-input>
              </ion-item>
              <ion-note *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched" class="error-note">
                <div *ngIf="registerForm.get('password')?.errors?.['required']">
                  <ion-icon name="alert-circle-outline"></ion-icon>
                  La contraseña es requerida
                </div>
                <div *ngIf="registerForm.get('password')?.errors?.['minlength']">
                  <ion-icon name="alert-circle-outline"></ion-icon>
                  Mínimo 6 caracteres
                </div>
              </ion-note>
            </div>
          </div>

          <!-- Sección de Datos Personales -->
          <div class="form-section">
            <h3 class="section-title">
              <ion-icon name="person-outline"></ion-icon>
              Datos Personales
            </h3>

            <!-- Nombre y Apellido en Grid -->
            <ion-grid class="ion-no-padding">
              <ion-row>
                <ion-col size="12" size-md="6">
                  <div class="input-group">
                    <ion-item lines="none" [class.error]="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched">
                      <ion-icon name="person-outline" slot="start"></ion-icon>
                      <ion-label position="floating">Nombre</ion-label>
                      <ion-input
                        formControlName="firstName"
                        type="text"
                        placeholder="Tu nombre">
                      </ion-input>
                    </ion-item>
                    <ion-note *ngIf="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched" class="error-note">
                      <ion-icon name="alert-circle-outline"></ion-icon>
                      El nombre es requerido
                    </ion-note>
                  </div>
                </ion-col>

                <ion-col size="12" size-md="6">
                  <div class="input-group">
                    <ion-item lines="none" [class.error]="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched">
                      <ion-icon name="person-outline" slot="start"></ion-icon>
                      <ion-label position="floating">Apellido</ion-label>
                      <ion-input
                        formControlName="lastName"
                        type="text"
                        placeholder="Tu apellido">
                      </ion-input>
                    </ion-item>
                    <ion-note *ngIf="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched" class="error-note">
                      <ion-icon name="alert-circle-outline"></ion-icon>
                      El apellido es requerido
                    </ion-note>
                  </div>
                </ion-col>
              </ion-row>
            </ion-grid>

            <!-- Documento de Identidad -->
            <div class="input-group">
              <ion-item lines="none" [class.error]="registerForm.get('identityDocument')?.invalid && registerForm.get('identityDocument')?.touched">
                <ion-icon name="card-outline" slot="start"></ion-icon>
                <ion-label position="floating">Documento de Identidad</ion-label>
                <ion-input
                  formControlName="identityDocument"
                  type="text"
                  placeholder="Número de documento">
                </ion-input>
              </ion-item>
              <ion-note *ngIf="registerForm.get('identityDocument')?.invalid && registerForm.get('identityDocument')?.touched" class="error-note">
                <ion-icon name="alert-circle-outline"></ion-icon>
                El documento es requerido
              </ion-note>
            </div>

            <!-- Fecha de Nacimiento -->
            <div class="input-group">
              <ion-item lines="none" [class.error]="registerForm.get('dateOfBirth')?.invalid && registerForm.get('dateOfBirth')?.touched">
                <ion-icon name="calendar-outline" slot="start"></ion-icon>
                <ion-label position="floating">Fecha de Nacimiento</ion-label>
                <ion-input
                  formControlName="dateOfBirth"
                  type="date"
                  placeholder="dd/mm/aaaa">
                </ion-input>
              </ion-item>
              <ion-note *ngIf="registerForm.get('dateOfBirth')?.invalid && registerForm.get('dateOfBirth')?.touched" class="error-note">
                <ion-icon name="alert-circle-outline"></ion-icon>
                La fecha de nacimiento es requerida
              </ion-note>
            </div>
          </div>
        </ion-card-content>
      </ion-card>

      <!-- Botones de Acción -->
      <div class="button-container">
        <ion-button
          type="submit"
          expand="block"
          [disabled]="registerForm.invalid || isLoading"
          class="submit-button">
          <ion-spinner *ngIf="isLoading" name="crescent"></ion-spinner>
          <span *ngIf="!isLoading">
            <ion-icon name="checkmark-circle-outline" slot="start"></ion-icon>
            Crear Cuenta
          </span>
        </ion-button>

        <ion-button
          expand="block"
          fill="clear"
          routerLink="/register"
          routerDirection="root"
          class="login-button">
          ¿Ya tienes cuenta?
          <strong>&nbsp;Inicia sesión</strong>
        </ion-button>
      </div>
    </form>
  </div>
</ion-content>
